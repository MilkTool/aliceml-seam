## -*- Makefile -*-
##
## Authors:
##   Thorsten Brunklaus <brunklaus@ps.uni-sb.de>
##   Leif Kornstaedt <kornstae@ps.uni-sb.de>
## 
## Copyright:
##   Thorsten Brunklaus, 2000
##   Leif Kornstaedt, 2000-2003
## 
## Last change:
##   $Date$ by $Author$
##   $Revision$
## 

srcdir = @srcdir@
VPATH = @srcdir@

BUILDTOP = ..
SRCTOP = $(srcdir)/..

include $(BUILDTOP)/Makefile.vars
include $(SRCTOP)/Makefile.rules

SOURCES = Map.cc WeakMap.cc Heap.cc Store.cc JITStore.cc
OBJS = $(SOURCES:%.cc=%.$(OBJEXT))

all: StoreConfig.hh $(OBJS)

StoreConfig.hh: StoreConfig.exe
	./$<

StoreConfig.exe: StoreConfig.$(OBJEXT)
	$(LD) $(LDFLAGS) -o $@ $<

clean:
	rm -f StoreConfig.$(OBJEXT) StoreConfig StoreConfig.exe
	rm -f $(OBJS) $(LIGHTNING_SOURCES0:%.cc=%.$(OBJEXT))

veryclean: clean

distclean: veryclean
	rm -f StoreConfig.hh Makefile.depend

Makefile: Makefile.in config.status
	./config.status

Makefile.depend: Makefile $(SOURCES) StoreConfig.hh
	$(MAKEDEPEND) $(SOURCES:%=$(srcdir)/%) $(srcdir)/StoreConfig.cc > $@

include Makefile.depend
